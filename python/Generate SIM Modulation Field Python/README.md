This is an implementation of the original matlab code. It is 4-5 times slower than the matlab implementation.
